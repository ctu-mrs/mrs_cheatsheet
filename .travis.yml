sudo: required
os:
- linux
dist: bionic
branches:
  only:
    - master
jobs:
  include:
    - stage: build
      before_install:
        - sudo apt -y update
        - sudo apt -y install texlive-latex-base texlive-latex-extra poppler-utils imagemagick
      script:
        - pdflatex -interaction=nonstopmode main.tex
        - pdftoppm -jpeg main.pdf thumbnail.jpg
        - montage *.jpg -mode Concatenate -tile 2x2 montage.jpg
        - convert montage.jpg -resize 1280 -quality 80 montage.jpg
        - mkdir -p output
        - mv main.pdf output/mrs_cheatsheet.pdf
        - mv montage.jpg output/thumbnail.jpg
      deploy:
        provider: pages
        skip_cleanup: true
        local_dir: output
        github_token: $GH_REPO_TOKEN
        on:
          branch: master
